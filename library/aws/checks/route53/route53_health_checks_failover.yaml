Provider: aws
CheckID: route53_health_checks_failover
CheckTitle: Route 53 Health Checks should be linked with failover policies
CheckType:
  - Reliability
ServiceName: route53
SubServiceName: health-checks
ResourceIdTemplate: "{Id}"
Severity: high
ResourceType: AWS::Route53::HealthCheck
Description: Checks whether Route 53 health checks are associated with failover routing policies.
Risk: Unlinked health checks won't trigger failover.
RelatedUrl: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover.html
Remediation:
  Code:
    CLI: "aws route53 change-resource-record-sets ..."
    NativeIaC: ""
    Other: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover.html
    Terraform: |
      resource "aws_route53_record" "example" {
        zone_id = aws_route53_zone.example.zone_id
        name    = "example.com"
        type    = "A"
        set_identifier = "primary"
        failover       = "PRIMARY"
        ttl            = 60
        records        = ["192.0.2.1"]
        health_check_id = aws_route53_health_check.example.id
      }

      resource "aws_route53_health_check" "example" {
        fqdn              = "example.com"
        port              = 80
        type              = "HTTP"
        resource_path     = "/"
        failure_threshold = 3
        request_interval  = 30
      }
  Recommendation:
    Text: Link Route 53 health checks to failover routing policies to ensure DNS failover functions correctly.
    Url: https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/dns-failover.html
Categories:
  - High Availability
  - Reliability
DependsOn: []
RelatedTo: []
Notes: